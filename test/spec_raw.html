<!-- <script src="../dist/Proto.js"></script> -->
<script>
var uid = 0;
var reSuper = /\bsuper\b/;
function implement(list){
	var proto = {}, collection = {};
	list = Array.isArray(list)? list : [list];
	for(var id = 0, item; id < list.length; id++){
		item = list[id];
		if(isFunction(item)){
			item = item.prototype;
		}
		for(var key in item){
			if(key !== 'constructor'){
				proto[key] = item[key];
			}
		}
		if(proto.implements){
			collection = implement(proto.implements);
		}else{
			collection = extend(collection, proto);
		}
	}
	return collection;
};
function copy(target){
	var Proto = function(){};
	Proto.prototype = target.prototype || target;
	return new Proto();
}
function copyShallowObjectsFrom(target){
	var copy = {};
	for(var key in target){
		if(isObject(target[key])){
			copy[key] = target[key];
		}
	}
	return copy;
}
function shallowMerge(target){
	var args = Array.prototype.slice.call(arguments, 1);
	for(var id = 0; id < args.length; id++){
		var source = args[id];
		if(source){
			for(var prop in source){
				target[prop] = source[prop];
			}
		}
	}
	return target;
}
function extend(proto, parent){
	if(proto && parent){
		proto = copy(proto);
		parent = copy(parent);
		for(var key in parent){
			if(isObject(parent[key])){
				extend(proto[key], parent[key]);
			}else{
				proto[key] = parent[key];
			}
		}
		return proto;
	}
	return proto || parent || {};
}
function merge(target){
	var args = Array.prototype.slice.call(arguments);
	for(var id = 1, source; id < args.length; id++){
		source = args[id];
		for(var property in source){
			if(source.hasOwnProperty(property)){
				if(isObject(source[property]) && isObject(target[property])){
					merge(target[property], source[property]);
				}else{
					target[property] = source[property];
				}
			}
		}
	}
	return target;
}
function createSuperMethod(name, action, pointer){
	pointer = isFunction(pointer)? pointer : function noop(){};
	return function(){
		this.super = pointer;
		return action.apply(this, arguments);
	};
}
function enableSuperMethods(parent, proto){
	for(var key in proto){
		if(isFunction(proto[key]) && reSuper.test(proto[key].toString()) && isLikeObject(parent.prototype)){
			proto[key] = createSuperMethod(key, proto[key], parent.prototype[key]);
		}
	}
	return proto;
}
function isObject(value){
	return Object.prototype.toString.call(value) === '[object Object]';
}
function isLikeObject(value){
	return value === Object(value);
}
function isFunction(value){
	return typeof value === 'function';
}

var Proto = {
	create: Object.create || function(proto, properties){
		var instance, property, Proto = function(){};
		Proto.prototype = proto;
		instance = new Proto();
		for(property in properties){
			if(properties.hasOwnProperty(property)){
				instance[property] = properties[property].value;
			}
		}
		return instance;
	},
	extends:function(protoProps, staticProps){
		// Wrap calls to `super` on object methods.
		enableSuperMethods(this, protoProps);

		// Create a default constructor.
		var parent = this;
		var child = function(){ return parent.apply(this, arguments); };
		var childObjects, implementations;

		// The constructor function for the new subclass is either defined by you
		// (the "constructor" property in your `extend` definition), or defaulted
		// by us to simply call the parent's constructor.
		if(protoProps && protoProps.hasOwnProperty('constructor')){
			child = protoProps.constructor;
		}

		// Add static properties to the constructor function, if supplied.
		shallowMerge(child, parent, staticProps);

		// Set the prototype chain to inherit from `parent`, without calling
		// `parent`'s constructor function.
		var Surrogate = function(){ this.constructor = child; };
		Surrogate.prototype = parent.prototype || null;
		child.prototype = Proto.create(Surrogate.prototype);

		// Adds implementations to the `__proto__` itself before inherit.
		if(protoProps && protoProps.hasOwnProperty('implements')){
			implementations = implement(protoProps.implements);
			child.prototype = extend(child.prototype, implementations);
			delete protoProps.implements;
		}

		// Add prototype properties (instance properties) to the subclass,
		// if supplied. Extends the objects too.
		if(protoProps){
			childObjects = copyShallowObjectsFrom(child.prototype);
			shallowMerge(child.prototype, protoProps, { $protoID:++uid });
			merge(child.prototype, childObjects);
		}

		// Set a convenience property in case the parent's prototype is needed
		// later.
		child.super = parent.prototype;

		return child;
	}
};
</script>
<script>
	// -------------------------------------------------------------------------------------
	// HumanVanilla
	// -------------------------------------------------------------------------------------
	var HumanVanilla = function(){
		console.log('i r human');
		this.super = function noop(){};
	};
	HumanVanilla.prototype.blau = function(){
		console.log('xablau!');
	};

	// -------------------------------------------------------------------------------------
	// ChuckNorrisVanilla
	// -------------------------------------------------------------------------------------
	var ChuckNorrisVanilla = function(){
		console.log('i r badass and.. ');
		this.super = HumanVanilla;
		this.super.call(this);
		this.kill('with thumb');
	};
	ChuckNorrisVanilla.prototype = Object.create(HumanVanilla.prototype);
	ChuckNorrisVanilla.prototype.constructor = ChuckNorrisVanilla;
	ChuckNorrisVanilla.super = HumanVanilla;
	ChuckNorrisVanilla.prototype.kill = function(flush){
		console.log('kill '+ flush);
	};

	// -------------------------------------------------------------------------------------
	// GodVanilla
	// -------------------------------------------------------------------------------------
	var GodVanilla = function(){
		console.log('i r god and.. ');
		this.super = ChuckNorrisVanilla;
		this.super.call(this);
		this.rise();
	};

	GodVanilla.prototype = Object.create(ChuckNorrisVanilla.prototype);
	GodVanilla.prototype.constructor = GodVanilla;
	GodVanilla.super = ChuckNorrisVanilla;

	GodVanilla.prototype.rise = function(){
		console.log('wait for three days!');
	};
	// -------------------------------------------------------------------------------------
	var humanVanilla = new HumanVanilla();
	var chuckNorrisVanilla = new ChuckNorrisVanilla();
	var godVanilla = new GodVanilla();
	console.log('>humanVanilla:', humanVanilla);
	console.log('>chuckNorrisVanilla:', chuckNorrisVanilla);
	console.log('>godVanilla:', godVanilla);




	console.log('-------------------------------------------------------------------------');
	// -------------------------------------------------------------------------------------
	// HumanProto
	// -------------------------------------------------------------------------------------
	var HumanProto = Proto.extends({
		options:{ waiting:'WAT?' },
		constructor:function HumanProto(){
			console.log('i r human');
		},
		blau:function(){
			console.log('xablau!');
		}
	});

	// -------------------------------------------------------------------------------------
	// ChuckNorrisProto
	// -------------------------------------------------------------------------------------
	var ChuckNorrisProto = HumanProto.extends({
		options:{ superkick:'yaaaa!!!' },
		constructor:function ChuckNorrisProto(){
			console.log('i r badass and.. ');
			this.super();
			this.kill('with thumb');
		},
		kill:function(flush){
			console.log('kill '+ flush);
		}
	});

	// -------------------------------------------------------------------------------------
	// GodProto
	// -------------------------------------------------------------------------------------
	var GodProto = ChuckNorrisProto.extends({
		options:{ biblia:'...' },
		constructor:function GodProto(){
			console.log('i r god and.. ');
			this.super();
			this.rise();
		},
		rise:function(){
			console.log('rise on third day!');
		}
	});
	// -------------------------------------------------------------------------------------
	var humanProto = new HumanProto();
	var chuckNorrisProto = new ChuckNorrisProto();
	var godProto = new GodProto();
	console.log('>humanProto:', humanProto);
	console.log('>chuckNorrisProto:', chuckNorrisProto);
	console.log('>godProto:', godProto);
	// -------------------------------------------------------------------------------------
</script>
